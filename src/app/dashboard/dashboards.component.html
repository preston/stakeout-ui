<!-- <toaster-container [toasterconfig]="toasterConfigurationService"></toaster-container> -->

<div id="dashboards" class="h-100">

    <div class="wrapper">

        <nav id="sidebar" [class.active]="sidebarActive" [class.inactive]="!sidebarActive">
            <div class="title">{{title}}</div>

            <ul class="list-unstyled components">
                <li>
                    <h4 class="mt-4">Dashboards
                        @if(editable()) {
                        <button class="ms-1 btn btn-sm btn-primary " role="button " (click)="create() "><span
                                class="bi-plus-circle"></span> Add</button>
                        }
                    </h4>
                    <ul class="list-unstyled" id="dashboards_list">
                        <li class="my-2" *ngFor="let d of dashboards" (click)="select(d)" role="button">
                            <!-- [routerLink]="'/dashboards/' + d.id" -->
                            @if(editable()) {
                            <button *ngIf="!editing[d.id]" class="me-1 btn btn-primary btn-sm" role="button"
                                (click)="editing[d.id] = true"><span class="bi-pencil"></span></button>
                            }
                            <span *ngIf="!editing[d.id]">{{d.name}}</span>
                            @if(editable()) {
                            <form (submit)="update(d)" role="form" class="form">
                                <div class="input-group">
                                    <input *ngIf="editing[d.id]" class="form-control form-control-sm" type="text"
                                        name="dashboard_name" [(ngModel)]="d.name" autofocus
                                        placeholder="My Dashboard" />
                                    <button *ngIf="editing[d.id]" class="btn btn-sm btn-primary" role="button"
                                        (click)="update(d)"><span class="bi-save"></span> Save</button>
                                </div>
                            </form>
                            <button *ngIf="!editing[d.id]" class="mx-1 btn btn-sm btn-danger float-end" role="button"
                                (click)="delete(d)"><span class="bi-trash"></span></button>
                            }
                        </li>
                    </ul>
                </li>

            </ul>
            <hr />
            <div class="mt-3 form-group">
                <label for="refresh">Auto-Refresh</label>
                <select class="form-control form-control-sm mt-1" [(ngModel)]="refresh" name="refresh">
                    <option *ngFor="let r of refresh_options" [value]="r.value" [selected]="r.value == refresh">
                        {{r.name}}</option>
                </select>
                <p *ngIf="refresh" class="text-center">
                    <small>
                        updated {{last_reload | amTimeAgo}}</small>
                </p>

            </div>

            <button class="mt-3 btn btn-sm btn-secondary float-end" [routerLink]="['/settings']"><span
                    class="bi bi-gear"></span></button>
        </nav>

        <div id="content">
            <button type="button" id="sidebarCollapse" class='navbar-btn' [class.active]="sidebarActive "
                [class.inactive]="!sidebarActive " (click)="toggleSidebar() ">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <dashboard *ngIf="dashboard_full " [dashboard]="dashboard_full"></dashboard>
        </div>
    </div>
</div>